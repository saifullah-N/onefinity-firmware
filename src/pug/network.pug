doctype html
html(lang="en")
  head
    meta(charset="utf-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")

    title Onefinity CNC - Web interface

    style: include ../static/css/pure-min.css
    style: include ../static/css/font-awesome.min.css
    style: include ../static/css/Audiowide.css
    style: include ../static/css/clusterize.css
    style: include ../svelte-components/node_modules/svelte-material-ui/bare.css
    style: include ../../build/http/svelte-components/smui.css
    style: include ../../build/http/svelte-components/style.css
    style: include:stylus ../stylus/style.styl

  body(v-cloak style="height:100vh; width:100vw; background-image: url('./images/getstartedBG.jpeg');background-size: cover;color:#777")
    #svelte-dialog-host

    #overlay(v-if="status != 'connected'")
      span {{status}}
    
    #layout
      a#menuLink.menu-link(href="#menu"): span

 
      #main
        .nav-header
          .brand
            img(src="/images/onefinity_logo.png")
            .version
                div 
                |  v{{config.full_version}} 
                div
                |  ip:{{config.ip}}
                div 
                | wifi:{{config.wifiName}}
              a.upgrade-link(v-if="show_upgrade()", href="#admin-general")
                | Upgrade to v{{latestVersion}}
              .fa.fa-exclamation-circle.upgrade-attention(v-if="show_upgrade()")
              
        div(style="text-align:center")
          .content(class="{{currentView}}-view")
            component(:is="currentView + '-view'", :index="index",
              :config="config", :template="template", :state="state", keep-alive)  
          div(style='display:flex; justify-content: space-around;')
            a(href='/defaultConfig/', style=' color:white ; background-color:#6F8DF5 ; font-size:20px; font-family:sans-serif ;  padding:15px 40px ; border-radius:8%;text-decoration: none;') previous 
            a(href='/buttonType/', style=' color:white ; background-color:#6F8DF5 ; font-size:20px; font-family:sans-serif ; padding:15px 40px ; border-radius:8%;text-decoration: none;') next

    message.error-message(:show.sync="errorShow")
      div(slot="header")
        .estop(:class="{active: state.es}"): estop(@click="estop")
        h3 ERROR: {{errorMessage}}

      div(slot="body")
        console

        button.pure-button(@click="block_error_dialog")
          .fa.fa-ban
          | &nbsp;Stop
        label showing errors for
        input(style="width: 50px", v-model="errorTimeout", number)
        label seconds.

      div(slot="footer")
        button.pure-button.pure-button-primary(@click="errorShow = false") Ok

    message(:show.sync="confirmUpgrade")
      h3(slot="header") Upgrade Firmware?
      div(slot="body")
        p
          | Are you sure you want to upgrade the firmware to version
          | {{latestVersion}}?

      div(slot="footer")
        button.pure-button(@click="confirmUpgrade=false") Cancel
        button.pure-button.pure-button-primary(@click="upgrade_confirmed")
          | Upgrade

    message(:show.sync="confirmUpload")
      h3(slot="header") Upload Firmware?
      div(slot="body")
        p Are you sure you want to upload firmware #[em {{firmwareName}}]?

      div(slot="footer")
        button.pure-button(@click="confirmUpload=false") Cancel
        button.pure-button.pure-button-primary(@click="upload_confirmed")
          | Upload

    message(:show.sync="firmwareUpgrading")
      h3(slot="header") Firmware upgrading
      div(slot="body")
        h3 Please wait...
        p This process should take less than 5 minutes.  If it takes longer than this, please restart the controller and try via USB.
      div(slot="footer")

    message(v-if="popupMessages.length", show=true)
      h3(slot="header") GCode message

      div(slot="body")
        ul
          li(v-for="msg in popupMessages", track-by="$index") {{msg}}

      div(slot="footer")
        button.pure-button.button-success(v-if="state.xx != 'HOLDING'",
          @click="close_messages('ok')") OK

        div(v-if="state.xx == 'HOLDING'")
          button.pure-button(@click="close_messages('stop')")
            | Stop
            .fa.fa-stop

          button.pure-button(@click="close_messages('continue')")
            | Continue
            .fa.fa-play

    #templates: include ../../build/templates.pug
    iframe#download-target(style="display:none")

    script: include ../static/js/vue.js
    script: include ../static/js/sockjs.min.js
    script: include ../static/js/clusterize.min.js
    script: include ../static/js/three.min.js
    script: include:browserify ../js/main.js
    script: include ../../build/http/svelte-components/index.js

